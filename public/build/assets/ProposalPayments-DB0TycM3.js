import{_ as D,r as d,o as n,c as _,w as u,f as b,t as l,a as i,e,n as k,b as c,d as m,k as C,F as V}from"./app-BMCubQSI.js";const N={props:{proposal:{type:Object,default:()=>({})}},data(){return{paid:0,paymentDialog:!1,saving:!1,submitted:!1,newPayment:{name:"",amount:"",paymentDate:null}}},created(){this.paid=parseFloat(this.proposal.amountPaid.replace(/,/g,""))},methods:{closeDialog(){this.paymentDialog=!1},openDialog(){this.paymentDialog=!0},submitPayment(){this.saving=!0,this.$inertia.post("/proposals/"+this.proposal.key+"/payment",{name:this.newPayment.name,amount:this.newPayment.amount*100,paymentDate:this.newPayment.paymentDate},{preserveScroll:!0,onSuccess:()=>{this.newPayment.name="",this.newPayment.amount="",this.newPayment.paymentDate=null,this.closeDialog()},onFinish:()=>{this.saving=!1}})},downloadReceipt(){window.open("/proposals/"+this.proposal.key+"/downloadReceipt","_blank")},deletePayment(h){this.$inertia.delete("/proposals/"+this.proposal.key+"/deletePayment/"+h.id,{preserveScroll:!0})}}},F={class:"p-field"},I=e("label",{for:"name"},"Name",-1),S={key:0,class:"p-error"},A={class:"p-field"},E=e("label",{for:"amount"},"Amount",-1),L={key:0,class:"p-error"},B={class:"p-field"},U=e("label",{for:"paymentDate"},"Payment Date",-1),j={key:0,class:"p-error"},R={class:"py-20 bg-gray-100"},T={class:"container mx-auto px-4"},q={class:"p-8 lg:p-20 bg-white"},M={class:"mb-20 text-5xl font-bold font-heading"},z={class:"flex flex-wrap items-center -mx-4"},O={class:"w-full xl:w-8/12 mb-8 xl:mb-0 px-4"},H=e("div",{class:"hidden lg:flex w-full"},[e("div",{class:"w-full lg:w-3/6"},[e("h4",{class:"mb-6 font-bold font-heading text-gray-500"}," Notes ")]),e("div",{class:"w-full lg:w-1/6"},[e("h4",{class:"mb-6 font-bold font-heading text-gray-500"}," Amount ")]),e("div",{class:"w-full lg:w-1/6 text-center","data-removed":"true"},[e("h4",{class:"mb-6 font-bold font-heading text-gray-500"}," Date ")])],-1),Y={key:0,class:"mb-6 py-6 border-t border-b border-gray-200"},G=e("span",{class:"bold"},"NO PAYMENTS HAVE BEEN RECEIVED",-1),J=[G],K=["onDblclick"],Q={class:"flex flex-wrap items-center -mx-4 mb-0 md:mb-3"},W={class:"w-full md:w-4/6 lg:w-6/12 px-4 mb-0 md:mb-0"},X={class:"flex -mx-4 flex-wrap items-center"},Z={class:"px-4"},$={class:"mb-2 text-xl font-bold font-heading"},ee={class:"lg:hidden text-gray-500"},te={class:"md:hidden text-lg text-blue-500 font-bold font-heading"},se={class:"hidden md:block lg:w-2/12 px-4"},oe={class:"text-lg text-blue-500 font-bold font-heading"},ne={class:"hidden lg:block lg:w-3/12 px-4"},le={class:"text-lg text-blue-500 font-bold font-heading"},ae={class:"lg:w-1/12 px-4"},ie={class:"text-lg text-blue-500 font-bold font-heading"},de={class:"flex flex-wrap content-around justify-evenly lg:-mb-4"},ce={class:"w-full xl:w-4/12 px-4"},me={class:"p-6 md:p-12 bg-blue-300"},re=e("h2",{class:"mb-6 text-4xl font-bold font-heading text-white"}," Totals ",-1),pe={class:"flex mb-8 items-center justify-between pb-5 border-b border-blue-100"},ue=e("span",{class:"text-blue-50"},"Agreed Price",-1),_e={class:"text-xl font-bold font-heading text-white"},he=e("h4",{class:"mb-2 text-xl font-bold font-heading text-white"}," Payments ",-1),be={class:"flex mb-2 justify-between items-center"},fe=e("span",{class:"text-blue-50"},"Amount Paid",-1),xe={class:"text-xl font-bold font-heading text-white"},ye={class:"flex mb-10 justify-between items-center"},ge=e("span",{class:"text-xl font-bold font-heading text-white"},"Payments Left",-1),we={class:"text-xl font-bold font-heading text-white"},ve={key:0,class:"text-2xl font-bold font-heading text-white text-center"},Pe=e("span",{class:"underline"},"PAID",-1),De=e("i",{class:"pi pi-check"},null,-1);function ke(h,a,o,Ce,t,r){const f=d("InputText"),x=d("InputNumber"),y=d("calendar"),p=d("Button"),g=d("Dialog"),w=d("Container"),v=d("Layout");return n(),_(v,null,{header:u(()=>[b(" Finalized Proposal - "+l(o.proposal.name),1)]),default:u(()=>[i(w,null,{default:u(()=>[i(g,{visible:t.paymentDialog,"onUpdate:visible":a[3]||(a[3]=s=>t.paymentDialog=s),style:{width:"450px"},header:"Make a payment",modal:!0,class:"p-fluid"},{footer:u(()=>[i(p,{label:"Cancel",icon:"pi pi-times",class:"p-button-text",onClick:r.closeDialog},null,8,["onClick"]),i(p,{label:t.saving?"Submitting Payment":"Submit Payment",disabled:t.saving,icon:"pi pi-check",class:"p-button-text",loading:t.saving,onClick:r.submitPayment},null,8,["label","disabled","loading","onClick"])]),default:u(()=>[e("div",F,[I,i(f,{id:"name",modelValue:t.newPayment.name,"onUpdate:modelValue":a[0]||(a[0]=s=>t.newPayment.name=s),modelModifiers:{trim:!0},required:"true",autofocus:"",class:k({"p-invalid":t.submitted&&!t.newPayment.name})},null,8,["modelValue","class"]),t.submitted&&!t.newPayment.name?(n(),c("small",S,"Name is required.")):m("",!0)]),e("div",A,[E,i(x,{id:"amount",modelValue:t.newPayment.amount,"onUpdate:modelValue":a[1]||(a[1]=s=>t.newPayment.amount=s),mode:"currency",currency:"USD",locale:"en-US",max:parseInt(o.proposal.amountLeft.replace(/,/g,""))},null,8,["modelValue","max"]),t.submitted&&!t.newPayment.amount?(n(),c("small",L,"Amount is required.")):m("",!0)]),e("div",B,[U,i(y,{id:"paymentDate",modelValue:t.newPayment.paymentDate,"onUpdate:modelValue":a[2]||(a[2]=s=>t.newPayment.paymentDate=s),"show-icon":!0},null,8,["modelValue"]),t.submitted&&!t.newPayment.paymentDate?(n(),c("small",j,"Date is required.")):m("",!0)])]),_:1},8,["visible"]),e("section",R,[e("div",T,[e("div",q,[e("h2",M," Payments - "+l(o.proposal.name),1),e("div",z,[e("div",O,[H,o.proposal.payments.length===0?(n(),c("div",Y,J)):m("",!0),(n(!0),c(V,null,C(o.proposal.payments,s=>(n(),c("div",{key:s.id,class:"mb-6 py-6 border-t border-b border-gray-200 cursor-pointer hover:bg-gray-100",onDblclick:P=>s.enableDelete=!s.enableDelete},[e("div",Q,[e("div",W,[e("div",X,[e("div",Z,[e("h3",$,l(s.name||"Unnamed payment"),1),e("p",ee,l(s.formattedPaymentDate),1),e("p",te," $"+l((parseInt(s.amount)/100).toFixed(2)),1)])])]),e("div",se,[e("p",oe," $"+l((parseInt(s.amount)/100).toFixed(2)),1)]),e("div",ne,[e("p",le,l(s.formattedPaymentDate),1)]),e("div",ae,[e("p",ie,[s.enableDelete?(n(),_(p,{key:0,icon:"pi pi-trash",class:"p-button-danger",onClick:P=>r.deletePayment(s)},null,8,["onClick"])):m("",!0)])])])],40,K))),128)),e("div",de,[o.proposal.amountLeft!=="0.00"?(n(),_(p,{key:0,icon:"pi pi-dollar",label:"Make Payment",class:"p-button-success",onClick:r.openDialog},null,8,["onClick"])):m("",!0),i(p,{icon:"pi pi-download",label:"Download Receipt",class:"p-button-default",onClick:r.downloadReceipt},null,8,["onClick"])])]),e("div",ce,[e("div",me,[re,e("div",pe,[ue,e("span",_e,"$"+l(parseFloat(o.proposal.price).toFixed(2)),1)]),he,e("div",be,[fe,e("span",xe,"$"+l(o.proposal.amountPaid),1)]),e("div",ye,[ge,e("span",we,"$"+l(o.proposal.amountLeft),1)]),o.proposal.amountLeft==="0.00"?(n(),c("div",ve,[Pe,b(),De])):m("",!0)])])])])])])]),_:1})]),_:1})}const Ne=D(N,[["render",ke]]);export{Ne as default};
