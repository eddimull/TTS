name: CI/CD Pipeline

on:
    push:
        branches: [master, staging, dev]
    pull_request:
        branches: [master, staging, dev]
jobs:
    frontend:
        uses: ./.github/workflows/frontend.yml
    backend:
        needs: [frontend]
        uses: ./.github/workflows/backendTests.yml
    deploy:
        needs: [frontend, backend]
        if: github.ref == 'refs/heads/master' || github.ref == 'refs/heads/staging'
        uses: ./.github/workflows/forgeDeploy.yml
        with:
            environment:  ${{ github.ref == 'refs/heads/master' && 'production' || 'staging' }}
        secrets: inherit

  